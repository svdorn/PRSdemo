# PRSdemo

### Set up
* Clone this repo into a folder on your local computer
```
git clone https://github.com/svdorn/PRSdemo.git
```
* Change directory into PRSdemo folder
```
cd PRSdemo
```

* `PRS_demo` is developed using R. The statistical computing software R (3.5) and the following packages are required:
  * [tidyverse](https://cran.r-project.org/web/packages/tidyverse/index.html)
  * [data.table](https://cran.r-project.org/web/packages/data.table/index.html)
  * [R.utils](https://cran.r-project.org/web/packages/R.utils/index.html)
  * [plyr](https://cran.r-project.org/web/packages/plyr/index.html)
  * [bigsnpr](https://cran.r-project.org/web/packages/bigsnpr/index.html)
  * [bigreadr](https://cran.r-project.org/web/packages/bigreadr/index.html)
  * [optparse](https://cran.r-project.org/web/packages/optparse/index.html)
  * [parallel](https://www.rdocumentation.org/packages/parallel/versions/3.6.2)
  * [foreach](https://cran.r-project.org/web/packages/foreach/index.html)
  * [rngtools](https://cran.r-project.org/web/packages/rngtools/index.html)

* Make output folder for PRS weights
```
mkdir weights
```

* Download LD and GWAS data
```
wget ftp://ftp.biostat.wisc.edu/pub/lu_group/Projects/PRS_demo/input
```

* Download PLINK
  * [Follow instuctions here](https://www.cog-genomics.org/plink/)

### Run
* To run the script to get PRS scores, run
```
bash calculate_prs.sh
```
* Output will be written to `prs_scores.txt` and look like:
FID	IID	ldpred2.1	ldpred2.2	ldpred2.3	ldpred2.4	ldpred2.5	ldpred2.6	ldpred2.7	ldpred2.8	ldpred2.9	ldpred2.10	ldpred2.11	default.1	default.2	default.3	default.4	default.5
HG00096	HG00096	-2.70991290634372	-2.36735577637384	-2.20472418421416	-2.21255632436199	-2.46801472101871	-2.56855271738966	-2.40802216816316	-2.30186265541202	-2.17828606751636	-2.17919647572342	-2.41047357895789	-1.89127190343713	-2.00332521338364	-2.12130652277332	-2.44830942378548	-2.36590377407605
HG00097	HG00097	-0.202214435264786	0.127935093984337	-0.0173102554344289	-0.509704837737267	0.148718229649148	-0.172781655860562	-0.545119528399885	0.116065641408602	-0.0728993047222043	-0.643105769792936	0.00948099930039965	-0.933596700287201	-1.22874727955847	-1.0968199523682	-1.21292302000459	-1.22259381543075
HG00099	HG00099	1.23913182209751	0.9071236178549	1.47326835677628	1.5776827245018	0.890438713435517	1.35525319790086	1.67275537311369	1.0213280607888	1.42749550031029	1.47536508504645	0.867623375100851	1.01674750142071	1.21564807124208	1.16426117861868	1.23831967612184	1.22782764970376
HG00101	HG00101	0.564273895493992	0.113741274763967	0.373513230044404	1.46130546582424	0.101573823024449	0.576187323905394	1.22294945936617	0.1591408624075	0.533272558783892	1.77859753029999	0.111396084483277	0.893027121223059	1.17180831545084	1.35772797130953	2.27653324838972	2.31864029754078
HG00102	HG00102	-0.554622487048772	-0.483446555721798	-0.983193659946143	-0.907363402500034	-0.551957728906816	-0.62874948593588	-0.836319154072728	-0.481738687114439	-1.00837316680712	-1.08359247198687	-0.341703665537058	-0.504729749308194	-0.532593219540616	-0.560753354098858	-0.929405361679379	-0.960385747227844
HG00103	HG00103	1.27939503416967	1.16356813329156	1.44370144709689	2.04760045967209	1.05764468916921	1.39474553080684	1.99808309492148	1.21658073947864	1.52167252223337	2.16559226800585	1.12866864514824	0.987515008233628	1.45292693941046	1.71552567399107	1.93860728648634	1.9873704716462
HG00105	HG00105	0.215958743659158	0.365390708974303	0.702467981104253	0.53815674540355	0.0481310409899971	0.393505027518648	0.43136571207144	0.392977420156913	0.651648805059568	0.561172410357013	0.0752910224136078	0.899766916939833	0.722530736748139	0.460365441953863	0.535330647110806	0.532025321735214
HG00107	HG00107	-0.293558212293751	-0.278074491687827	-0.257935381190508	0.583901545711725	-0.338993242450971	-0.129859447329692	0.336507996891871	-0.30923697616213	-0.243591694567268	0.583263790235877	-0.432760814919265	0.175350223198213	1.02676986952763	0.998230932945586	0.998681213950998	0.983633792896368
